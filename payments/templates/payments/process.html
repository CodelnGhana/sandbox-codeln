{% extends 'recruiterbase.html' %}
{% block title %}
Payment
{% endblock %}
{%load static %}
{% block content %}
<main role="main" class="col-md-9 ml-sm-auto col-lg-10 pt-3 px-4">
    <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pb-2 mb-3  fley">
        <div class="navbar fixed-top fine border-bottom">

            <h5>Payment</h5>

            <nav>

                <ul class="nav ">
                    <!-- Authentication Links -->
                    <li class="nav-item">
                        <span data-feather="user">

                        </span>
                        {{ user.username }}
                    </li>
                    {% if request.user.is_authenticated %}
                    <li class="nav-item">
                        <a href="{% url 'account_logout' %}" class="navbar-item w3-opacity" title="Logout">Logout</a>
                    </li>
                    {% else %}
                    <li class="nav-item">
                        <a class="nav-item" href="{% url 'account_login' %}" class="navbar-item">Login</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-item" href="{% url 'account_signup' %}" class="navbar-item">Register</a>
                    </li>
                    {% endif %}


                </ul>

            </nav>
        </div>

    </div>

    <div class="row">

        <div class="col-lg-6" style="margin: auto">
            <div class="card" style="width: 28em;box-shadow:0 20px 50px rgba(0,0,0,.1);">
                <img class="card-img-top" style="width: 75%;margin: auto" src="/static/frontend/images/ill/card.svg" alt="Card image cap">

                <div class="card-body">
                    <div class=" text-center h5" style="padding-top: 10%">Payment methods</div>
                    <hr>

                        <div class="row" style="margin: auto">
                            <div class="col-lg-4">
                                <h6 style="margin-top:10% ">Paypal</h6>
                            </div>
                            <div class="col-lg-3">
                                {{ form.render }}
                            </div>
                        </div>
                    <hr>
                    <div class="row" style="margin: auto">
                        <div class="col-lg-4">
                            <h6 style="margin-top:10% ">Flutterwave</h6>
                        </div>
                        <div class="col-lg-3">
                    <form style="text-align: -webkit-center;">
                        {#                    <script src="https://api.ravepay.co/flwv3-pug/getpaidx/api/flwpbf-inline.js"></script>#}
                        <script src="https://ravesandboxapi.flutterwave.com/flwv3-pug/getpaidx/api/flwpbf-inline.js"></script>
                        <a onClick="payWithRave('{{amount}}')"><img style="width: 10rem" src="/static/frontend/images/flutter.svg"></a>
                        
                    </form>
                    {#            <footer class="modal-card-foot">#}
                    {#                <button class="button is-info">Total Cost = {{ total_amount }}</button>#}
                    {#                <a href="{% url 'payments:pay' current_transaction.id %}" class="button is-success">#}
                        {#                    Proceed to make Payment.</a>#}
                    {#            </footer>#}
                        </div>
                    </div>


                </div>
            </div>

        </div>

    </div>

</main>
<script>
    function openTab(tabName) {
        var i;
        var x = document.getElementsByClassName('letab');
        for (i = 0; i < x.length; i++) {
            x[i].style.display = "none"
        }
        document.getElementById(tabName).style.display = "block";
    }
    const API_publicKey = "FLWPUBK-37320275f784b16ec1e30b1342c0a223-X";

    function payWithRave(amnt) {
        console.log(amnt);
        var x = getpaidSetup({
            PBFPubKey: API_publicKey,
            customer_email: "user@example.com",
            amount: amnt,
            customer_phone: "234099940409",
            currency: "USD",
            payment_method: "both",
            txref: "rave-123456",
            meta: [{
                metaname: "flightID",
                metavalue: "AP1234"
            }],
            onclose: function () {
            },
            callback: function (response) {
                var txref = response.tx.txRef; // collect txRef returned and pass to a 					server page to complete status check.
                console.log("This is the response returned after a charge", response);
                if (
                    response.tx.chargeResponseCode == "00" ||
                    response.tx.chargeResponseCode == "0"
                ) {
                    // redirect to a success page
                } else {
                    // redirect to a failure page.
                }

                x.close(); // use this to close the modal immediately after payment.
            }
        });
    }
</script>


{% endblock %}
